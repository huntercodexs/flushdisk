# Flushdisk
A small shell script project to help anyone on clean and save logs generated by backend services

# Requirements

- Operating System: Linux
- Secure Connection: SSH
- Public Key(optional): PEM, PPK, RSA
- Linux Commands: TAR
- Permissions (in some cases): SUDO

> It was tested in the Ubuntu 20.04, CentOS, Amazon Linux 2, Red Hat8 and Open Suse (Leap 15.5)

# About

![flushdisk-overview.png](documents/midias/flushdisk-overview.png)

Looking in the image above we can see a remote use and local use, that can be understandably easy to understand only 
read the image content. We can see that the remote execution depends on local execution ate been installed and working 
correctly, so have a caution when you are install the flushdisk locally because the remote flushdisk will require it.

# How to work

- Locally

Like we can see in the image below, the local flushdisk execution is pretty simple. After the correct installation,
configuration and preparation from the services, the flushdisk will be make the following steps:

1. Import the system colors from script flushdisk-system-colors.sh
2. Read global file configuration called flushdisk.conf
3. Read all services configuration files placed in the services-conf folder
4. Execute one by one of these services read previously to check, compact and finally clear the log path
5. The final step is copy the files compacted (tar.gz) into backup folder

![flushdisk.png](documents/midias/flushdisk.png)

- Remotely

In the remote execution we have the same scenario described above for the sub topic "Locally", but when we execute the 
remote flushdisk, the following steps will be coming together: 

1. Import the system colors from script flushdisk-system-colors.sh
2. Read all remote services configurations placed in the remote-services-conf
3. Execute one by one of these remote services in the local flushdisk execution (keep in your mind that the remote flushdisk are placed in the remote machine, and the flushdisk local/client/service are placed and running int the another machine)
4. Like described in the step 3, the remote flushdisk execute the flushdisk (local) via ssh 
5. After the complete execution from flushdisk (local/client/service) the compacted files (tar.gz) are copied for the remote flushdisk machine
6. Finally, the files compacted are saved in the folder backup separated by folder service name according the image below

> IMPORTANT: Look that there is a flushdisk.sh script in the path when we are using the remote flushdisk, and it can
> be made without problems, there is no trouble or conflict in todo that, it's perfectly possible. However, keep in your 
> mind that will be running remote and local instances of the flushdisk, and it can be little confusing to check the 
> backup logs in the backup folder path.

![remote-flushdisk.png](documents/midias/remote-flushdisk.png)

# Installing

- Local
- Remote

# Configuration

- Flushdisk Config
- Services Config
- Remote Flushdisk Services Config

# Use Cases

- Use Case: Flushdisk 1:1 (One Machine for One Service)

![flushdisk-1-1.png](documents/midias/flushdisk-1-1.png)

- Use Case: Flushdisk 1:N (One Machine for Many Services)

![flushdisk-1-N.png](documents/midias/flushdisk-1-N.png)

- Use Case: Remote Flushdisk 1:1 (One Machine for One Service) 

![remote-flushdisk-1-1.png](documents/midias/remote-flushdisk-1-1.png)

- Use Case: Remote Flushdisk 1:N

![remote-flushdisk-1-N.png](documents/midias/remote-flushdisk-1-N.png)

- Use Case: Remote Flushdisk N:1 (Many Machines for One Service)

![remote-flushdisk-N-1.png](documents/midias/remote-flushdisk-N-1.png)

- Use Case: Remote Flushdisk N:N (Many Machine for Many Services)